<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Set 和 Map 数据结构</title>
  </head>
  <body>
    <div id="demo">1</div>
    <div>2</div>
    <div>3</div>
    <script>
      // 1.Set
      // const arr = [1, 2, 3, 4, 5, 4, 3, 2, 1];
      // const s1 = new Set(arr);
      // console.dir(s1);
      // console.dir([...s1]);
      // const s1 = new Set();
      // document.querySelectorAll('div').forEach(div => s1.add(div));
      // console.dir(s1, s1.size);
      // const s2 = new Set(document.querySelectorAll('div'));
      // console.log(s2, s2.size);
      // const str = 'ababbc';
      // const s3 = new Set(str)
      // console.dir(str);
      // console.dir(s3);
      // console.dir([...s3].join(''));

      // let set = new Set();
      // let a = NaN;
      // let b = NaN;
      // set.add(a);
      // set.add(b);
      // console.log(set);; // Set {NaN}

      // 两个对象总是不相等的
      // let set = new Set();
      // set.add({});
      // console.log(set.size); // 1
      // console.dir(set);
      // set.add({});
      // console.log(set.size); // 2
      // console.dir(set);

      // const s1 =new Set();
      // s1.add(1).add(2).add(2).add(3)
      // console.dir(s1);
      // s1.delete(2)
      // console.dir(s1);
      // console.log(s1.has(1));
      // console.log(s1.has(2));

      // const items = new Set([1, 2, 3, 4, 5]);
      // const array1 = Array.from(items);
      // const array2 = [...items];
      // console.log('items', items);
      // console.log('array1', array1);
      // console.log('array2', array2);
      // console.log(Object.keys(array2));
      // console.log(Object.values(array2));
      // console.log(Object.entries(array2));
      // console.log('Set.prototype', Set.prototype);
      // console.log(
      //   'Set.prototype[Symbol.iterator] === Set.prototype.values',
      //   Set.prototype[Symbol.iterator] === Set.prototype.values
      // );

      // let set = new Set(['red', 'green', 'blue']);

      // for (let x of set) {
      //   console.log(x);
      // }

      // set键名和键值是同一个值
      // let set = new Set([1, 4, 9]);
      // set.forEach((element, index) => {
      //   console.log('element', element, typeof element);
      //   console.log('index', index, typeof index);
      //   console.log('-------------------');
      // });
      /*
      // (method) ArrayConstructor.from<T>(arrayLike: ArrayLike<T>): T[] (+3 overloads)
      let set = new Set([1, 2, 3, 2, 1]);
      set = new Set(Array.from(set, val => val * 100));
      console.dir(set);
      const ws = new WeakSet();
      console.log('ws 0:', ws)
      // ws.add(1) // Uncaught TypeError: Invalid value used in weak set
      ws.add(Symbol())
      ws.add(new Date())
      ws.add({a:1})
      console.log('ws 1:', ws)
      // for (const iterator of ws) {
      //   console.log('iterator', iterator) // Uncaught TypeError: ws is not iterable
      // }
      */

      // 2.Map
      // const obj = {};
      // const node = document.getElementById('demo');
      // obj[node] = '666';
      // console.log('node', node);
      // console.log('obj', obj);
      // console.log(Object.keys(obj));
      // console.log(Object.values(obj));
      // console.log(Object.entries(obj));
      // // element被自动转为字符串[object HTMLDivElement]

      // const m = new Map();
      // const o = { p: 'Hello World' };

      // m.set(o, 'content');
      // console.log('m 1', m, m.size);
      // m.get(o); // "content"

      // m.has(o); // true
      // m.delete(o); // true
      // console.log('m 2', m, m.size);
      // m.has(o); // false

      // const map = new Map([
      //   ['name', '张三'],
      //   ['title', 'Author']
      // ]);
      // console.dir(map, map.size);
      // console.log(map.has('name'));
      // console.log(map.has('title'));
      // console.log(map.get('name'));
      // console.log(map.get('title'));

      // const items = [
      //   ['name', '张三'],
      //   ['title', 'Author']
      // ];
      // const map = new Map();
      // items.forEach(([key, value]) => map.set(key, value));
      // console.dir(map);
      // console.log(map.keys());
      // console.log(map.values());
      // console.log(map.entries());
      // console.dir(Symbol);

      // const set = new Set([
      //   ['foo', 1],
      //   ['bar', 2]
      // ]);
      // console.dir(set);
      // console.dir(set.keys());
      // console.dir(set.values());
      // console.dir(set.entries());
      // const m1 = new Map(set);
      // console.dir(m1);
      // console.dir(m1.get('foo'));
      // console.dir(m1.get('bar'));
      // console.log('------------');
      // const m2 = new Map([['baz', 3]]);
      // const m3 = new Map(m2);
      // console.dir(m2);
      // console.dir(m3);
      // console.log(m3.get('baz')); // 3

      // const map = new Map();
      // map.set(1, 'aaa').set(1, 'bbb');
      // console.dir(map);
      // console.dir(map.get('111'));

      // const map = new Map();
      // const arr = ['a'];
      // map.set(arr, 555);
      // console.dir(map.get(arr)); // 555

      // const map = new Map();

      // const k1 = ['a'];
      // const k2 = ['a'];

      // map.set(k1, 111).set(k2, 222);
      // console.dir(map);
      // console.dir(map.get(k1));; // 111
      // console.dir(map.get(k2));; // 222
      // // 变量k1和k2的值是一样的，但是它们在 Map 结构中被视为两个键。

      // let map = new Map();
      // map.set(NaN, 123);
      // map.set(NaN, 456);
      // console.dir(map.get(NaN));; // 456

      // const map = new Map();
      // map.set('foo', true);
      // map.set('bar', false);
      // console.dir(map);

      // const m = new Map();
      // m.set('edition', 6); // 键是字符串
      // m.set(262, 'standard'); // 键是数值
      // m.set(undefined, 'nah'); // 键是 undefined
      // console.dir(m);
      // console.log(m.get('edition'));
      // console.log(m.get(262))
      // console.log(m.get(undefined))
      // console.log(m.has('edition'));
      // console.log(m.has(262))
      // console.log(m.has(undefined))
      // m.delete('edition');
      // m.delete(262);
      // m.delete(undefined);
      // console.dir(m);
      // m.set(1,'aaa').set(2,'bbb').set(3,'ccc')
      // console.dir(m);
      // m.clear()
      // console.dir(m);

      // const map = new Map([
      //   [1, 'a'],
      //   [2, 'b']
      // ]);
      // console.dir(map);
      // console.dir(map.keys());
      // console.dir(map.values());
      // console.dir(map.entries());
      // for (const item1 of map.keys()) {
      //   console.log('item1', item1);
      // }
      // for (const item2 of map.values()) {
      //   console.log('item2', item2);
      // }
      // for (const [key, value] of map) {
      //   console.log('key', key);
      //   console.log('value', value);
      //   console.log('------------');
      // }
      // console.dir(map[Symbol.iterator] === map.entries);

      // const map = new Map([
      //   [1, 'one'],
      //   [2, 'two'],
      //   [3, 'three']
      // ]);
      // console.dir(map);
      // // console.log([...map.keys()]);
      // // console.log([...map.values()]);
      // // console.log([...map.entries()]);
      // console.log('[...map]', [...map]);
      // console.log(JSON.stringify([...map.entries()]));
      // console.log(JSON.stringify([...map]));
      // console.log(JSON.stringify([...map.entries()]) === JSON.stringify([...map]));
      // const map0 = new Map().set(1, 'a').set(2, 'bb').set(3, 'ccc');
      // console.dir(map0);
      // map0.forEach(element => {
      //   console.log('element 0:', element);
      // });
      // const map1 = new Map([...map0].map(([k, v]) => [k * 2, v + v]));
      // console.dir(map1);
      // map1.forEach(element => {
      //   console.log('this 1', this)
      //   console.log('element 1:', element);
      // });

      // const map2 = new Map([...map0].filter(([k, v]) => k < 3 && v.length > 1));
      // console.dir(map2);

      // const myMap = new Map().set(true, 7).set({ foo: 3 }, ['abc']);
      // const arr = [...myMap];
      // console.log('arr', arr);

      // function strMapToObj(strMap) {
      //   // let obj = Object.create(null);
      //   let obj = {};
      //   for (let [k, v] of strMap) {
      //     console.log('k', k)
      //     console.log('v', v)
      //     console.log('--------------');
      //     obj[k] = v;
      //   }
      //   return obj;
      // }

      // const myMap = new Map().set('yes', true).set('no', false).set({a:1}, 'hahaha');
      // const res = strMapToObj(myMap);
      // // { yes: true, no: false }
      // console.dir(res);

      // let obj = {"a":1, "b":2};
      // console.log(Object.entries(obj));
      // let m = new Map(Object.entries(obj));
      // console.dir(m);

      // function objToStrMap(obj) {
      //   let strMap = new Map();
      //   for (let k of Object.keys(obj)) {
      //     strMap.set(k, obj[k]);
      //   }
      //   return strMap;
      // }
      // const res = objToStrMap({ yes: true, no: false });
      // console.dir(res);

      // function strMapToObj(strMap) {
      //   // let obj = Object.create(null);
      //   let obj = {};
      //   for (let [k, v] of strMap) {
      //     console.log('k', k)
      //     console.log('v', v)
      //     console.log('--------------');
      //     obj[k] = v;
      //   }
      //   return obj;
      // }
      // console.log({a:1}['a']);

      // let obj = {"a":1, "b":2};
      // console.log(Object.entries(obj));
      // let m = new Map(Object.entries(obj));
      // console.dir(m);

      // let myMap = new Map().set('yes', true).set('no', false);
      // console.dir(myMap);
      // let myMap1 = new Map([
      //   ['yes', true],
      //   ['no', false]
      // ]);
      // console.dir(myMap1);
      // console.dir(JSON.stringify([...myMap]));
      // console.dir(JSON.stringify([...myMap1]));

      // let myMap2 = new Map().set(true, 7).set({foo: 3}, ['abc']);
      // console.dir(myMap2);
      // console.dir([...myMap2]);
      // console.dir(JSON.stringify([...myMap2]));
      // console.dir(JSON.stringify(Array.from(myMap2)));

      // const jsonstr = '[[true,7],[{"foo":3},["abc"]]]';
      // const arr =JSON.parse(jsonstr)
      // const map  = new Map(arr)
      // console.dir(arr);
      // console.dir(JSON.stringify(arr))
      // console.dir(map);

      // WeakMap
      // 目前进度: https://wangdoc.com/es6/set-map#weakmap
    </script>
  </body>
</html>
